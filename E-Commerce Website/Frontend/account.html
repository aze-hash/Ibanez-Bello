<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Profile - ShopLife</title>
  <link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="shop.css" />
  <link rel="stylesheet" href="account.css" />
  
</head>
<body>
  <!-- Header -->
  <header class="shop-header">
    <div class="nav container d-flex">
      <div class="logo"><h1>ShopLife</h1></div>
      <ul class="shop-nav d-flex">
        <li><a href="shop.html"><i class='bx bx-store'></i> Home</a></li>
        <li><a href="favorites.html" class="nav-link"><i class='bx bx-heart'></i> Favorites</a></li>
        <li><a href="cart.html" class="nav-link"><i class='bx bx-cart'></i> Cart</a></li>
        <li><a href="profile.html" class="nav-link active"><i class='bx bx-user'></i> Account</a></li>
      </ul>
    </div>
  </header>

  <!-- Account Dashboard -->
<section class="account-dashboard container">

  <!-- LEFT SIDE: PROFILE INFO -->
  <div class="account-sidebar">
    <div class="profile-card">
      <div class="profile-header">
        <div class="profile-img">
          <img src="./Images/user.png" alt="User Profile Picture" />
        </div>
        <h2 id="username">Jane Doe</h2>
        <p id="userEmail">janedoe@email.com</p>
      </div>

      <div class="profile-info">
        <h3>Account Details</h3>
        <div class="info-item"><span class="label">Full Name:</span> <span id="fullName">Jane Doe</span></div>
        <div class="info-item"><span class="label">Email:</span> <span id="email">janedoe@email.com</span></div>
        <div class="info-item"><span class="label">Phone:</span> <span id="phone">+63 912 345 6789</span></div>
        <div class="info-item"><span class="label">Address:</span> <span id="address">123 Main Street, Lucena City</span></div>
      </div>

      <div class="profile-actions">
        <button class="btn edit-profile"><i class='bx bx-edit'></i> Edit Profile</button>
        <button class="btn logout" onclick="location.href='index.html'"><i class='bx bx-log-out'></i> Logout</button>
      </div>
    </div>
  </div>

  <!-- RIGHT SIDE: ORDERS DASHBOARD -->
  <div class="account-main">

    <!-- Order Tabs -->
    <div class="order-tabs">
      <button class="order-tab active" data-tab="orders">Orders</button>
      <button class="order-tab" data-tab="ship">To Ship</button>
      <button class="order-tab" data-tab="receive">To Receive</button>
      <button class="order-tab" data-tab="completed">Completed</button>
    </div>

    <!-- TAB CONTENT -->
    <div class="tab-content active" id="orders">
      <p>No orders found.</p>
    </div>

    <div class="tab-content" id="ship">
      <p>No items to ship.</p>
    </div>

    <div class="tab-content" id="receive">
      <p>No items to receive.</p>
    </div>

    <div class="tab-content" id="completed">
      <p>No completed orders yet.</p>
    </div>

  </div>
</section>


  <!-- Edit Profile Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeModal">&times;</span>
      <h3>Edit Profile</h3>
      <input type="text" id="editName" placeholder="Full Name" />
      <input type="email" id="editEmail" placeholder="Email" />
      <input type="text" id="editPhone" placeholder="Phone" />
      <input type="text" id="editAddress" placeholder="Address" />
      <button class="btn" id="saveChanges">Save Changes</button>
    </div>
  </div>
  <!-- Order Details Modal -->
<div id="orderDetailsModal" class="modal">
  <div class="modal-content order-summary-modal">
    <span class="close-btn" id="closeOrderModal">&times;</span>
    <h3>Order Details</h3>
    <div class="order-summary">
      <img id="orderDetailImg" src="" alt="Product Image" />
      <div class="order-summary-info">
        <p><strong>Product:</strong> <span id="orderDetailName"></span></p>
        <p><strong>Price:</strong> ₱<span id="orderDetailPrice"></span></p>
        <p><strong>Quantity:</strong> <span id="orderDetailQty"></span></p>
        <p><strong>Date:</strong> <span id="orderDetailDate"></span></p>
        <p><strong>Total:</strong> ₱<span id="orderDetailTotal"></span></p>
      </div>
    </div>
  </div>
</div>


  <footer class="shop-footer">
    <p>&copy; 2025 ShopLife. All rights reserved.</p>
  </footer>
<script>
  // Modal functionality
  const editBtn = document.querySelector('.edit-profile');
  const modal = document.getElementById('editModal');
  const closeBtn = document.getElementById('closeModal');
  const saveBtn = document.getElementById('saveChanges');

  editBtn.addEventListener('click', () => {
    // Pre-fill current info
    document.getElementById('editName').value = document.getElementById('fullName').textContent;
    document.getElementById('editEmail').value = document.getElementById('email').textContent;
    document.getElementById('editPhone').value = document.getElementById('phone').textContent;
    document.getElementById('editAddress').value = document.getElementById('address').textContent;

    modal.style.display = 'flex';
  });

  closeBtn.addEventListener('click', () => {
    modal.style.display = 'none';
  });

  window.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.style.display = 'none';
    }
  });

  // Save changes
  saveBtn.addEventListener('click', () => {
    document.getElementById('fullName').textContent = document.getElementById('editName').value;
    document.getElementById('username').textContent = document.getElementById('editName').value;
    document.getElementById('email').textContent = document.getElementById('editEmail').value;
    document.getElementById('userEmail').textContent = document.getElementById('editEmail').value;
    document.getElementById('phone').textContent = document.getElementById('editPhone').value;
    document.getElementById('address').textContent = document.getElementById('editAddress').value;
    modal.style.display = 'none';
  });

  // Tabs functionality
  const tabs = document.querySelectorAll(".order-tab");
  const contents = document.querySelectorAll(".tab-content");

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");

      contents.forEach(c => c.classList.remove("active"));
      document.getElementById(tab.dataset.tab).classList.add("active");
    });
  });

  // Load Orders and add Cancel functionality
  function loadOrders() {
    const orders = JSON.parse(localStorage.getItem("orders")) || [];
    const ordersContainer = document.getElementById("orders");

    if (orders.length === 0) {
      ordersContainer.innerHTML = "<p>No orders found.</p>";
      return;
    }

    ordersContainer.innerHTML = orders
      .map((order, index) => `
        <div class="order-item">
          <img src="${order.image}" class="order-img" />
          <div class="order-details">
            <h4>${order.name}</h4>
            <p>₱${order.price}</p>
            <span class="order-status">${order.status}</span>
          </div>
          <button class="cancel-order" data-index="${index}">Cancel Order</button>
        </div>
      `)
      .join("");

    // Add event listeners for cancel buttons
    const cancelButtons = ordersContainer.querySelectorAll(".cancel-order");
    cancelButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const orderIndex = parseInt(btn.dataset.index);

        const reason = prompt(
          "Please select a reason for cancellation:\n1. No longer needed\n2. I need to change the delivery address\n3. Other (please specify)"
        );

        if (reason) {
          let reasonText = "";
          if (reason === "1") {
            reasonText = "No longer needed";
          } else if (reason === "2") {
            reasonText = "I need to change the delivery address";
          } else {
            reasonText = reason;
          }

          const confirmCancel = confirm(`Are you sure you want to cancel this order?\nReason: ${reasonText}`);

          if (confirmCancel) {
            orders[orderIndex].status = `Cancelled: ${reasonText}`; // Update status with reason
            localStorage.setItem("orders", JSON.stringify(orders)); // Save updated array
            loadOrders(); // Refresh the list
          }
        } else {
          alert("Cancellation reason is required.");
        }
      });
    });
  }

  document.addEventListener("DOMContentLoaded", loadOrders);
  function loadOrders() {
  const orders = JSON.parse(localStorage.getItem("orders")) || [];
  const ordersContainer = document.getElementById("orders");

  if (orders.length === 0) {
    ordersContainer.innerHTML = "<p>No orders found.</p>";
    return;
  }

  ordersContainer.innerHTML = orders
    .map((order, index) => `
      <div class="order-item" data-index="${index}">
        <img src="${order.image}" class="order-img" />
        <div class="order-details">
          <h4>${order.name}</h4>
          <p>₱${order.price}</p>
        </div>
        <button class="cancel-order" data-index="${index}">Cancel Order</button>
      </div>
    `)
    .join("");

  // Cancel button event
  const cancelButtons = ordersContainer.querySelectorAll(".cancel-order");
  cancelButtons.forEach(btn => {
    btn.addEventListener("click", (e) => {
      e.stopPropagation(); // prevent opening modal
      const orderIndex = parseInt(btn.dataset.index);
      orders.splice(orderIndex, 1);
      localStorage.setItem("orders", JSON.stringify(orders));
      loadOrders();
    });
  });

  // Open Order Details Modal
  const orderItems = ordersContainer.querySelectorAll(".order-item");
  const orderModal = document.getElementById("orderDetailsModal");
  const closeOrderModal = document.getElementById("closeOrderModal");

  orderItems.forEach(item => {
    item.addEventListener("click", () => {
      const index = parseInt(item.dataset.index);
      const order = orders[index];

      document.getElementById("orderDetailImg").src = order.image;
      document.getElementById("orderDetailName").textContent = order.name;
      document.getElementById("orderDetailPrice").textContent = parseFloat(order.price).toFixed(2);
      document.getElementById("orderDetailQty").textContent = order.quantity;
      document.getElementById("orderDetailDate").textContent = order.date;
      document.getElementById("orderDetailTotal").textContent = (parseFloat(order.price) * order.quantity).toFixed(2);

      orderModal.style.display = "flex";
    });
  });

  closeOrderModal.addEventListener("click", () => {
    orderModal.style.display = "none";
  });

  window.addEventListener("click", (e) => {
    if (e.target === orderModal) {
      orderModal.style.display = "none";
    }
  });
}

</script>

</body>
</html>
